---
comments: true
title: [Swift ) 옵셔널(Optional)]
key: 202001281
modify_date: 2020-07-03
picture_frame: shadow
tags:
  - [swift]
---
 
# 옵셔널(Optional)
 
```
var num: Int
num = nil // error!
```
이 코드가 정상적으로 작동할까?
 
`'nil' cannot be assigned to type 'Int'` 에러가 발생한다.
에러내용을 보면 Int 타입에 nil이 올 수 없는다는 내용인데,   
> `nil`은 값이 없다는 것을 표현한다.
 
```
var num: Int?
num = nil
```
Int에 **?** 를 붙여주니 잘 작동한다.
```
var num: Int!
num = nil
```
이번에도 역시 **!** 를 붙여주니 잘 작동한다.
**옵셔널 기호(?/!)** 를 붙여주면 이 변수에 값이 있을 수도 없을 수도 있기 때문에 nil을 할당해도 에러가 나지 않는 것이다.
그렇다면 옵셔널이란 뭘까?
 
### 옵셔널이란?
 
옵셔널(Optional)은 스위프트의 특징 중 하나인 **안정성**을 기반으로 하는 문법으로, 값이 있을 수도 없을 수도 있는 것을 나타낸다.   
그리고 옵셔널은 처음 선언, 즉 초기화할 때 값을 할당해주지 않아도 된다. 옵셔널이기 때문이다.   
물론 값을 할당해주지 않는다면 값은 자동적으로 nil이다.
 
옵셔널을 박스에 포장되어 있는 값이라고 생각해보자.
그렇다면 우리가 그동안 선언한 변수는 박스에 포장되어 있지 않은 것이다.   
옵셔널은 박스를 오픈에 그 안에 있는 값을 확인하는 것인데, 오픈할 때 두가지 방법이 있다.
 
### ?
 
**?** 로 포장된 것은 노크를 해 값이 있는지, 없는지 대답을 들어 확인하는 방법이다.   
값이 있다면 값을 반환하고, 값이 없다면 nil을 반환한다.   
*참고로 nil도 메모리 차지를 한다.*
 
```
var num: Int? = 5
```
이제 이러한 코드를 보면 알 수 있다.   
**num이라는 변수에는 Int값이 올 수도 있고, nil이 올 수도 있다.**
```
var num: Int? = 5
var new = num
```
만약 옵셔널타입인 num을 new라는 새로운 변수에 할당해준다면 new는...?
옵셔널타입을 할당받는 순간 **new**라는 변수도 마찬가지로 옵셔널타입이 된다.   
`var new: Int`라고 해도 이미 new는 Int?타입이기 때문에 에러가 난다.
 
### !
 
**!** 로 포장된 포장된 것은 값이 있든 없든 포장을 깨부시고 확인하는 방법이다.   
깨부셨을 때 값이 있으면 있는 것이고, 없으면 없는 값의 유무를 상관하지 않는 방법이라고 할 수 있다.   
```
var num: Int? = 5
var new = num!
```
이렇게 된다면 new는 어떤 타입일까?   
옵셔널타입인 num을 깨부시고 안에 있는 값을 할당한 것이니, **new는 Int타입**이다.
```
var num: Int? = nil
var new: Int = num! // error!
```
num은 옵셔널타입이기 때문에 nil을 할당할 수 있다. 그러나, new는 Int타입이기 때문에 `Unexpectedly found nil while unwrapping an Optional value` 이라는 에러가 발생한다.
```
var num: Int? = nil
var new = num! // error!
```
이 역시도 같은 에러가 발생한다. 왤까?   
nil이라는 값에 접근하려고 하면 100% 런타임 에러가 발생한다.   
**즉!! 웬만하면 !는 사용하지 말자.**
 
그래서 나는 !가 붙는 것을 보고 "얘는 무조건 값 있다! 없으면 X됨." 이렇게 해석하기로 했다.   
그리고 ?가 붙은 것은 "얘는 값이 있을 수도 있고, 없을 수도 있어. 할당할거면 확인해봐" 이렇게 해석하고 있다.   
좀 웃기지만 이렇게 해석하는게 가장 이해가 잘 된다.   
 
그렇다면 안전하게 옵셔널값을 가져올 수 있는 방법에 대해 알아보자.
 
# 옴셔널 바인딩
 
옵셔널 바인딩은 옵셔널타입 변수에 값이 있는지, 없는지 먼저 확인해주는 작업을 말한다.   
확인한 후 값이 있을 때와 없을 때 다르게 코드를 실행시킬 수 있다.
```
if let 값이 있다면 값을 할당할 변수 = 옵셔널타입 변수 {
    // 값이 있을 때 실행할 코드
} else {
    // 값이 없을 때(nil일 때) 실행할 코드
}
```
기본코드는 이렇게 구성되어 있는데 `if let`도 결국 if 기반 구문이기 때문에 `else`구문을 생략할 수 있다.
```
if let 값이 있다면 값을 할당할 변수 = 옵셔널타입 변수 {
    // 값이 있을 때 실행할 코드
}
```
만약 이렇게 `if let`으로만 구성되어 있다면 값이 없을 때 실행될 코드는 없는 것이다.
물론 `if var`라고 사용할 수 있지만 옵셔널 바인딩을 할 때는 거의 해당 값에 값을 주려는 것보다 값을 사용하는 경우가 많기 때문에 `if let`을 훨씬 많이 본 것이다.   
```
if let 값이 있다면 값을 할당할 변수1 = 옵셔널타입 변수1, 값이 있다면 값을 할당할 변수2 = 옵셔널타입 변수2 {
    // 두 변수 모두 값이 있을 때 실행할 코드
}
```
그리고 말했듯이 if 기반 구문이기 때문에 &&를 할용할 수 있다.   
*(&& 대신 , 쓸 수 있는 건 다 알겠죠..?)*
 
# 옵셔널 체이닝
 
옵셔널 체이닝은 하위 프로퍼티에 옵셔널 값이 있는지 .을 통해 **연속적**으로 체이닝하여 확인할 수 있는 방법이다.   
중간에 nil 값이 하나라도 발견된다면 전체 반환값이 nil로 반환된다.
```
class SomeClass {
    var some = "some"
}
 
class OtherClass {
    var other: SomeClass?
}
 
let value = OtherClass()
print(value.other?.some) // nil
```
이 
