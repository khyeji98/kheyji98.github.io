---
comments: true
title: [Swift ) ARC(Automatic Reference Counting)]
key: 202004031
modify_date: 2021-01-15
picture_frame: shadow
tags:
  - [swift]
---
 
## ARC란?
 
ARC란 Automatic Reference Counting의 약자로, 자동참조카운팅을 통해 앱의 메모리 사용을 추적하고 관리하는 기능이다.   
자동참조카운팅은 인스턴스가 몇 번 참조되는지 카운팅하는 것이며 인스턴스를 참조한다는 것은 `var example = Intance()`에서 `Instance()` 이렇게 변수 example에 의해 참조되는 것을 말한다.   
그리고 ARC는 이 참조를 추적해 인스턴스 참조가 몇 번 일어나는지 세어주며 참조의 수가 0이 되면 해당 인스턴스는 **메모리에서 해제**된다.
바로 `example = nil` 이런식으로 메모리에서 해제되어 Instance를 램에서 제거하는 것이다.   
    
    
자동참조카운팅은 **오직 클래스의 인스턴스에만 적용**된다.   
말 그대로 ARC는 인스턴스의 **"참조"** 를 추적하는 것이고, 구조체이나 열거형과 달리 클래스는 복사가 아니라 **참조**를 통해 인스턴스에 접근이 가능하기 때문이다.
 
## ARC 동작 방법
 
ARC는 클래스에 새 인스턴스가 정의될 때마다 해당 인스턴스에 대한 정보를 저장하기 위해 메모리를 할당한다.
그리고 메모리에는 인스턴스의 타입 정보와 인스턴스의 값을 저장한다.   
더이상 인스턴스가 필요하지 않으면 자동으로 메모리에서 비우는 방식으로 메모리를 관리한다.   
그러나!! 인스턴스를 해제하면 해당 인스턴스의 프로퍼티나 메소드에 접근할 수 없고, 이 때 접근하려하면 앱에서 충돌이 발생한다.   
따라서 인스턴스를 필요로 하는 동안에는 메모리에서 해제되지 않게 하기 위해 **인스턴스 할당할 때 강한 참조(Strong Reference)를 연결하고 ARC가 인스턴스의 참조를 추적**하는 것이다.
```
class Person {
    let name: String
    
    init(name: String) {
        self.name = name
        print("\(name) is being initialized")
    }
    
    deinit {
        print("\(name) is being deinitialized")
    }
}
```
이렇게 Person이라는 클래스가 정의되고 클래스에 인스턴스가 정의되면서 ARC가 Person 인스턴스를 추적하고 관리한다.
```
var reference1: Person?
var reference2: Person?
var reference3: Person?
```
그리고 Person 클래스를 세 변수에 정의했다. 이 때까지는 아직 참조카운팅이 발생하지 않는다.   
Person 클래스가 옵셔널로 호출되어 아직 참조는 발생하지 않았기 때문이다.
```
reference1 = Person(name: "John Appleseed") // "John Appleseed is being initialized"
```
Person 클래스가
reference1 = Person(name: "John Appleseed")
 
#### Reference)
 
[https://shinhyogeun.tistory.com/2](https://shinhyogeun.tistory.com/2)
